<form id="scanForm">
  <input type="text" id="websiteInput" placeholder="example.com" required>
  <button type="submit">Scan My Website</button>
</form>

<div class="spinner-container">
  <div class="spinner"></div>
  <p>Scanning... Please wait.</p>
</div>
<div class="progress-container">
  <div class="progress-bar"></div>
</div>
<pre id="results"></pre>

<script>
  document.getElementById("scanForm").addEventListener("submit", async function(e) {
    e.preventDefault();
    document.querySelector('.spinner-container').style.display = 'block';
    document.querySelector('.progress-container').style.display = 'block';

    const website = document.getElementById("websiteInput").value;

    try {
      const response = await fetch('https://website-scanner-backend.onrender.com/api/scan', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({website: website})
      });

      const data = await response.json();
      document.querySelector('.spinner-container').style.display = 'none';
      document.querySelector('.progress-container').style.display = 'none';

      const resultBox = document.getElementById("results");
      resultBox.textContent = data.result || data.error || "Unknown error.";
    } catch (error) {
      console.error(error);
      alert("Error scanning website. Try again!");
      document.querySelector('.spinner-container').style.display = 'none';
      document.querySelector('.progress-container').style.display = 'none';
    }
  });
</script>
